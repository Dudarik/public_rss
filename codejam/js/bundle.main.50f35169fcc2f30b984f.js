(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var a=n.getElementsByTagName("script");a.length&&(t=a[a.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t+"../"})();const t=(e=0)=>{let t=parseInt(e%3600/60,10),n=parseInt(e%3600%60,10);return t=t<10?"0"+t:String(t),n=n<10?"0"+n:String(n),`${t}:${n}`},n=(e,t,n,a,o)=>{[e[t][n],e[a][o]]=[e[a][o],e[t][n]]},a=(e,t,n,a)=>!(e<0||t<0||e>n||t>a),o=(e,t,n)=>{if(isNaN(t)||isNaN(n))return null;const o=[-1,0,1,0],s=[0,1,0,-1],r=e.length-1,i=e[0].length-1;for(let m=0;m<o.length;m++)if(a(t+o[m],n+s[m],r,i)&&0===e[t+o[m]][n+s[m]]){if(0===m)return{direction:"up",coords:[t+o[m],n+s[m]]};if(1===m)return{direction:"right",coords:[t+o[m],n+s[m]]};if(2===m)return{direction:"down",coords:[t+o[m],n+s[m]]};if(3===m)return{direction:"left",coords:[t+o[m],n+s[m]]}}return null},s={gameArray:[],gameWinArray:[],gameSettings:{sound:!0,numbers:!0,boardSizes:[3,4,5,6,7,8],currentBoardSize:4},ls_available:!1,ls_key_data:"fifteen_data",ls_key_settings:"fifteen_settings",ls_key_records:"fifteen_records",records:{3:[{name:"AAA",movesCount:20,playTime:100},{name:"BBB",movesCount:30,playTime:200},{name:"CCC",movesCount:40,playTime:300},{name:"DDD",movesCount:50,playTime:400},{name:"EEE",movesCount:60,playTime:500},{name:"FFF",movesCount:70,playTime:600},{name:"GGG",movesCount:80,playTime:700},{name:"HHH",movesCount:90,playTime:800},{name:"JJJ",movesCount:100,playTime:900},{name:"KKK",movesCount:110,playTime:1e3}],4:[{name:"BBB",movesCount:100,playTime:500},{name:"CCC",movesCount:120,playTime:600},{name:"DDD",movesCount:130,playTime:700},{name:"EEE",movesCount:140,playTime:800},{name:"FFF",movesCount:150,playTime:900},{name:"GGG",movesCount:160,playTime:1e3},{name:"DDD",movesCount:170,playTime:1100},{name:"MMM",movesCount:180,playTime:1200},{name:"LOL",movesCount:190,playTime:1300},{name:"KEK",movesCount:200,playTime:1400}],5:[{name:"KKK",movesCount:300,playTime:600},{name:"BBB",movesCount:320,playTime:700},{name:"LOL",movesCount:330,playTime:800},{name:"DDD",movesCount:340,playTime:900},{name:"EEE",movesCount:350,playTime:1e3},{name:"FFF",movesCount:360,playTime:1100},{name:"FOX",movesCount:370,playTime:1200},{name:"HHH",movesCount:380,playTime:1300},{name:"JJJ",movesCount:390,playTime:1400},{name:"KKK",movesCount:400,playTime:1500}],6:[{name:"AAA",movesCount:500,playTime:2e3},{name:"LOL",movesCount:520,playTime:2200},{name:"CCC",movesCount:530,playTime:2300},{name:"FOX",movesCount:540,playTime:2400},{name:"EEE",movesCount:550,playTime:2500},{name:"FFF",movesCount:560,playTime:2600},{name:"BUG",movesCount:570,playTime:2700},{name:"HHH",movesCount:580,playTime:2800},{name:"KEK",movesCount:590,playTime:2900},{name:"KKK",movesCount:500,playTime:5e3}],7:[{name:"AAA",movesCount:700,playTime:4e3},{name:"BBB",movesCount:710,playTime:4200},{name:"CCC",movesCount:730,playTime:4300},{name:"LEL",movesCount:740,playTime:4400},{name:"EEE",movesCount:750,playTime:4500},{name:"FFF",movesCount:760,playTime:4600},{name:"GGG",movesCount:770,playTime:4700},{name:"VAS",movesCount:780,playTime:4800},{name:"IDA",movesCount:790,playTime:4900},{name:"REA",movesCount:853,playTime:5e3}],8:[{name:"FOX",movesCount:1e3,playTime:7e3},{name:"LOL",movesCount:1020,playTime:7200},{name:"KEK",movesCount:1030,playTime:7300},{name:"REA",movesCount:1040,playTime:7400},{name:"ALX",movesCount:1050,playTime:7500},{name:"MRX",movesCount:1060,playTime:7600},{name:"JHO",movesCount:1070,playTime:7700},{name:"ING",movesCount:1080,playTime:7800},{name:"INP",movesCount:1090,playTime:7900},{name:"VOX",movesCount:1100,playTime:8e3}]},playTime:0,movesCount:0,inGame:!1,gameTimerId:null,dragndrop:!1,dragableStartPosX:0,dragableStartPosY:0,dragableEndPosX:0,dragableEndPosY:0,animationDropableTime:400,inDropable:!1},r=(e,t)=>!!s.ls_available&&(localStorage.setItem(e,JSON.stringify(t)),!0),i=e=>!!s.ls_available&&JSON.parse(localStorage.getItem(e)),m=e.p+"assets/6e1f7ceff265ea7fe037.mp3",l=()=>{s.gameTimerId=setInterval((()=>{s.playTime=s.playTime+1,H()}),1e3),s.inGame=!0},d=()=>{s.gameTimerId&&clearInterval(s.gameTimerId),s.inGame=!1,s.playTime=0,s.movesCount=0,s.gameTimerId=null,I(),H()},c=()=>{s.dragndrop=!1},u=()=>{s.movesCount+=1,I()},p=()=>s.gameArray.flat().join("")===s.gameWinArray.flat().join(""),g=()=>{clearInterval(s.gameTimerId),s.inGame=!1,s.gameSettings.sound&&new Audio(m).play();const e=document.querySelector(".popup_overlay"),n=document.querySelector(".popup_card");n.innerHTML="",document.createElement("div").classList.add("victory_title"),n.innerHTML=`\n    <h3 class='victory_title'>!!! VICTORY !!!</h3>\n    <div class='victory_subtitle'>Hooray! You solved the puzzle in ${t(s.playTime)} and ${s.movesCount} moves!</div>\n  `;const a=document.createElement("div");if(a.classList.add("close_popup"),a.addEventListener("click",(()=>{e.classList.remove("popup_overlay_active")})),n.append(a),s.movesCount<s.records[s.gameSettings.currentBoardSize][9].movesCount){const t=document.createElement("input"),a=document.createElement("div");a.classList.add("newrecord_title");const o=document.createElement("h4");o.innerText="Congratulations! This is a new record!";const s=document.createElement("br"),r=document.createElement("span");r.innerText="Enter your name:",n.append(a,o,s,r),t.type="text",t.className="record_name",t.placeholder="Input your name here... max 10 symbols",t.oninput=()=>{t.value.length>8&&(t.value=t.value.slice(0,8))};const i=document.createElement("button");i.innerText="SAVE",i.classList.add("btnRecords_save"),i.addEventListener("click",(()=>{v(t.value),e.classList.remove("popup_overlay_active")})),n.append(t,i)}e.classList.add("popup_overlay_active")},v=e=>{const t=s.gameSettings.currentBoardSize,{movesCount:n,playTime:a}=s;console.log(s.records[t]),s.records[t].push({name:e,movesCount:n,playTime:a}),s.records[t].sort(((e,t)=>e.movesCount-t.movesCount)),s.records[t]=s.records[t].slice(0,10),console.log(s.records[t]),r(s.ls_key_records,s.records)},y=e=>{const n=s.records[e],a=(e,t,n,a)=>{const o=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div");return o.classList.add("records_num"),s.classList.add("records_name"),r.classList.add("records_moves"),i.classList.add("records_time"),o.innerText=e,s.innerText=t,r.innerText=n,i.innerText=a,[o,s,r,i]},o=[],r=a("№","NAME","MOVES","TIME"),i=document.createElement("div");i.classList.add("record_str"),i.append(...r),o.push(i);for(let e=0;e<n.length;e++){const s=document.createElement("div");s.classList.add("record_str");const r=a(e+1,n[e].name,n[e].movesCount,t(n[e].playTime));s.append(...r),o.push(s)}return o},T=()=>{const e={sound:s.gameSettings.sound,currentBoardSize:s.gameSettings.currentBoardSize};r(s.ls_key_settings,e)},b=()=>{const e=s.gameSettings.currentBoardSize;s.gameArray=[],s.gameWinArray=[];for(let t=0;t<e;t++){const n=[];for(let a=0;a<e;a++)n.push(t*e+a+1);s.gameArray.push(n)}s.gameArray[e-1][e-1]=0;for(let e=0;e<s.gameArray.length;e++)s.gameWinArray.push([...s.gameArray[e]])},S=e.p+"assets/c7ea62c4967b91c643bc.mp3",C=e.p+"assets/952d6d7245270401f426.mp3",E=e.p+"assets/d0c05eae0a0cf06463b5.mp3",_=e.p+"assets/d6b189d8b2681bc52026.mp3",L=()=>{d(),b(),s.gameSettings.sound&&new Audio(C).play(),s.gameArray=((e,t=1e3,a=!1)=>{let o=e.length-1,s=e.length-1;a||(e.length>5&&(t=2e3),3===e.length&&(t=100));for(let a=0;a<t;a++)switch(Math.floor(4*Math.random()+0)){case 0:0!==o&&n(e,o,s,--o,s);break;case 1:o!==e.length-1&&n(e,o,s,++o,s);break;case 2:0!==s&&n(e,o,s,o,--s);break;case 3:s!==e.length-1&&n(e,o,s,o,++s)}return e})(s.gameArray,5,!0),s.movesCount=0,s.inGame=!0,w(),l()},f=e=>{d(),s.gameSettings.currentBoardSize=e.target.value,T(),b(),w()},h=e=>{const t=e.target.dataset.r,a=e.target.dataset.c,o=document.querySelector(".dropable"),r=o.dataset.r,i=o.dataset.c;n(s.gameArray,r,i,t,a),u(),e.target.classList.remove(`move_${s.animationDirection}`),s.animationDirection=null,w(),p()&&(console.log("win"),g()),document.querySelector("#board").addEventListener("mouseup",B)},A=e=>{s.inGame&&null!==o(s.gameArray,+e.target.dataset.r,+e.target.dataset.c)&&(s.dragndrop=!0,setTimeout((()=>{if(!s.dragndrop)return;const t=e.target;if(!t||"dropable"===t.id)return;const a=document.querySelector(`#${e.target.id}`);let o=e.clientX-a.getBoundingClientRect().left,r=e.clientY-a.getBoundingClientRect().top;const i=document.createElement("div");i.classList.add("cell"),i.innerHTML=a.innerHTML,i.style.cursor="grabbing",i.style.width=a.getBoundingClientRect().width+"px",i.style.height=a.getBoundingClientRect().height+"px",document.body.append(i),i.style.position="absolute",i.style.zIndex=1e3,i.style.opacity=.75,i.style.fontSize=s.gameSettings.currentBoardSize<6?"2rem":"1rem",s.dragableStartPosX=a.getBoundingClientRect().left,s.dragableStartPosY=a.getBoundingClientRect().top;const m=(e,t)=>{i.style.left=e-o+"px",i.style.top=t-r+"px"};let l=null;const d=e=>{s.inDropable=!1,e.style.background="",e.style.opacity=0},v=e=>{m(e.pageX,e.pageY),i.classList.add("displaynone");let t=document.elementFromPoint(e.clientX,e.clientY);if(i.classList.remove("displaynone"),!t)return;let n=t.closest("#dropable");var a;l!=n&&(l&&d(l),l=n,l&&(a=l,s.inDropable=!0,a.style.background="#e2f5fc",a.style.opacity=.2))},y=e=>{if(s.inDropable){const e=document.querySelector("#dropable");s.dragableStartPosX=e.getBoundingClientRect().left,s.dragableStartPosY=e.getBoundingClientRect().top}s.dragableEndPosX=i.getBoundingClientRect().left,s.dragableEndPosY=i.getBoundingClientRect().top,i.style.transition=`all ${s.animationDropableTime}ms`,i.style.transform=`translate(${s.dragableStartPosX-s.dragableEndPosX}px, ${s.dragableStartPosY-s.dragableEndPosY}px)`,setTimeout((()=>{if(i.remove(),s.inDropable){const e=a.dataset.r,t=a.dataset.c,o=document.querySelector("#dropable"),r=o.dataset.r,i=o.dataset.c;n(s.gameArray,r,i,e,t),s.gameSettings.sound&&new Audio(E).play(),u(),w(),p()&&g(),d(l)}}),s.animationDropableTime),document.removeEventListener("mousemove",v),i.removeEventListener("mouseup",y)};document.addEventListener("mousemove",v),i.addEventListener("mouseup",y),m(e.pageX,e.pageY),c()}),150))},B=e=>{if(!s.inGame)return;c();const t=e.target;if(t){document.querySelector(`#${e.target.id}`).addEventListener("transitionend",h);const r=o(s.gameArray,+t.dataset.r,+t.dataset.c);r&&(s.gameSettings.sound&&new Audio(S).play(),n=e.target,a=r.direction,s.animationDirection=a,n.classList.add(`move_${a}`))}var n,a},z=()=>{s.ls_available||alert("Для того, чтобы сохранения были доступны, включите возможность записи в localstorage! В насатройках вашего браузера!");const e={gameArray:s.gameArray,gameWinArray:s.gameWinArray,playTime:s.playTime,movesCount:s.movesCount,inGame:s.inGame,gameSettings:{currentBoardSize:s.gameSettings.currentBoardSize}};r(s.ls_key_data,e)},x=()=>{if(!s.ls_available)return void alert("Для того, чтобы сохранения были доступны, включите возможность записи в localstorage! В насатройках вашего браузера!");d();const e=i(s.ls_key_data);if(e){for(const t in e)"gameSettings"!==t?Object.hasOwnProperty.call(e,t)&&(s[t]=e[t]):s.gameSettings.currentBoardSize=+e.gameSettings.currentBoardSize;const t=document.querySelectorAll("#boardsize > option");for(let e=0;e<t.length;e++)t[e].selected=!1,+t[e].value===s.gameSettings.currentBoardSize&&(t[e].selected=!0);w(),I(),H(),l()}},$=e=>{const t=document.querySelectorAll(".btnRecords"),n=e.target.dataset.bSize,a=document.querySelector("#restitle");for(let e=0;e<t.length;e++)t[e].classList.remove("btnRecords_active"),t[e].dataset.bSize===n&&(t[e].classList.add("btnRecords_active"),a.innerHTML=`Best of the best ${n} X ${n}`);const o=document.querySelector(".record_table");o.innerHTML="",o.append(...y(n))},k=()=>{s.gameSettings.sound&&new Audio(_).play();const e=document.querySelector(".popup_overlay"),t=document.querySelector(".popup_card"),n=document.createElement("div"),a=s.gameSettings.currentBoardSize,o=s.gameSettings.boardSizes;n.innerHTML=`<h3 id='restitle'>Best of the best ${a} X ${a}</h3>`;const r=document.createElement("div");r.classList.add("close_popup"),r.addEventListener("click",(()=>e.classList.remove("popup_overlay_active"))),n.append(r);const i=document.createElement("div");i.classList.add("btn_rec_wrapper");for(let e=0;e<o.length;e++){const t=document.createElement("button");t.innerText=`${o[e]} X ${o[e]}`,t.addEventListener("click",$),t.classList.add("btnRecords"),t.dataset.bSize=o[e],o[e]===a&&t.classList.add("btnRecords_active"),i.append(t)}n.append(i);const m=document.createElement("div");m.classList.add("record_table");const l=y(a);m.append(...l),t.innerHTML="",t.append(n),t.append(m),e.classList.add("popup_overlay_active")},D=e=>{s.gameSettings.sound?(s.gameSettings.sound=!1,e.target.innerText="Sound OFF",e.target.classList.add("btn_sound_disable"),T()):(s.gameSettings.sound=!0,e.target.innerText="Sound ON",e.target.classList.remove("btn_sound_disable"),T())},F=(e,t,n)=>{const a=document.createElement("span");return a.classList.add(...n),a.innerText=`${e}: ${t}`,a},w=()=>{const e=s.gameSettings.currentBoardSize,t=s.gameArray,n=document.getElementById("board"),a=[];n.className="",n.classList.add("board",`board_${e}_${e}`);for(let n=0;n<t.length;n++)for(let o=0;o<t[n].length;o++){const s=n*e+o,r=document.createElement("div");r.id=`cell_${s}`,r.classList.add("cell"),0===t[n][o]&&(r.classList.add("dropable"),r.setAttribute("id","dropable")),r.dataset.r=n,r.dataset.c=o,r.innerText=t[n][o],a.push(r)}n.innerHTML="",n.append(...a)},I=()=>{document.querySelector(".moves_count").innerText=`Moves: ${s.movesCount}`},H=()=>{document.querySelector(".play_time").innerText=`Time: ${t(s.playTime)}`};(()=>{if(s.ls_available=(()=>{try{const e="test";return localStorage.setItem(e,JSON.stringify(e)),localStorage.removeItem(e),!0}catch(e){return console.log(e),!1}})(),s.ls_available){const e=i(s.ls_key_settings);e&&(s.gameSettings.sound=e.sound,s.gameSettings.currentBoardSize=+e.currentBoardSize)}(()=>{const e=i(s.ls_key_records);e&&(s.records=e)})(),b(),(()=>{const e=document.createElement("div");e.classList.add("container");const t=document.createElement("div");t.classList.add("popup_overlay"),t.setAttribute("id","popup_overlay");const n=document.createElement("div");n.classList.add("close_popup");const a=document.createElement("div");return a.classList.add("popup_card"),t.addEventListener("click",(e=>{"popup_overlay"===e.target.id&&(e.stopPropagation(),e.preventDefault(),t.classList.remove("popup_overlay_active"))})),n.addEventListener("click",(()=>{t.classList.remove("popup_overlay_active")})),a.append(n),t.append(a),e.append(t),document.body.innerHTML="",document.body.append(e),e})().append((()=>{const e=s.gameSettings.boardSizes,t=document.createElement("div");t.classList.add("buttons");const n=document.createElement("select");for(let t=0;t<e.length;t++){const a=document.createElement("option");a.setAttribute("value",e[t]),e[t]===s.gameSettings.currentBoardSize&&(a.selected=!0),a.innerText=`${e[t]} X ${e[t]}`,n.append(a)}n.setAttribute("id","boardsize"),n.addEventListener("change",f),t.append(n);const a=document.createElement("button"),o=document.createElement("button"),r=document.createElement("button"),i=document.createElement("button"),m=document.createElement("button");return a.innerText="Shuffle and start",o.innerText=s.gameSettings.sound?"Sound ON":"Sound OFF",r.innerText="Save",i.innerText="Load",m.innerText="Results",s.gameSettings.sound||o.classList.add("btn_sound_disable"),a.addEventListener("click",L),o.addEventListener("click",D),r.addEventListener("click",z),i.addEventListener("click",x),m.addEventListener("click",k),t.append(a,o,r,i,m),t})(),(()=>{const e=document.createElement("div");e.classList.add("stats");const t=F("Moves",0,["moves_count"]),n=F("Time","00:00",["play_time"]);return e.append(t,n),e})(),(()=>{const e=document.createElement("div");return e.classList.add("board"),e.setAttribute("id","board"),e.addEventListener("mousedown",A),e.addEventListener("mouseup",B),e})())})(),w()})();