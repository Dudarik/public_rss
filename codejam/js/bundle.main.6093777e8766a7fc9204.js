(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var a=n.getElementsByTagName("script");a.length&&(t=a[a.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t+"../"})();const t=(e=0)=>{let t=parseInt(e%3600/60,10),n=parseInt(e%3600%60,10);return t=t<10?"0"+t:String(t),n=n<10?"0"+n:String(n),`${t}:${n}`},n=(e,t,n,a,o)=>{[e[t][n],e[a][o]]=[e[a][o],e[t][n]]},a=(e,t=1e3,a=!1)=>{let o=e.length-1,r=e.length-1;a||(e.length>5&&(t=2e3),3===e.length&&(t=100));for(let a=0;a<t;a++)switch(Math.floor(4*Math.random()+0)){case 0:0!==o&&n(e,o,r,--o,r);break;case 1:o!==e.length-1&&n(e,o,r,++o,r);break;case 2:0!==r&&n(e,o,r,o,--r);break;case 3:r!==e.length-1&&n(e,o,r,o,++r)}return e},o=(e,t,n,a)=>!(e<0||t<0||e>n||t>a),r=(e,t,n)=>{if(isNaN(t)||isNaN(n))return null;const a=[-1,0,1,0],r=[0,1,0,-1],s=e.length-1,i=e[0].length-1;for(let m=0;m<a.length;m++)if(o(t+a[m],n+r[m],s,i)&&0===e[t+a[m]][n+r[m]]){if(0===m)return{direction:"up",coords:[t+a[m],n+r[m]]};if(1===m)return{direction:"right",coords:[t+a[m],n+r[m]]};if(2===m)return{direction:"down",coords:[t+a[m],n+r[m]]};if(3===m)return{direction:"left",coords:[t+a[m],n+r[m]]}}return null},s={gameArray:[],gameWinArray:[],gameSettings:{sound:!0,numbers:!0,boardSizes:[3,4,5,6,7,8],currentBoardSize:4},ls_available:!1,ls_key_data:"dudarik_fifteen_data",ls_key_settings:"dudarik_fifteen_settings",ls_key_records:"dudarik_fifteen_records",records:{3:[{name:"AAA",movesCount:25,playTime:150},{name:"BBB",movesCount:35,playTime:250},{name:"CCC",movesCount:45,playTime:350},{name:"DDD",movesCount:50,playTime:450},{name:"EEE",movesCount:60,playTime:550},{name:"FFF",movesCount:70,playTime:650},{name:"GGG",movesCount:80,playTime:750},{name:"HHH",movesCount:90,playTime:850},{name:"JJJ",movesCount:100,playTime:950},{name:"KKK",movesCount:110,playTime:1e3}],4:[{name:"BBB",movesCount:100,playTime:500},{name:"CCC",movesCount:120,playTime:600},{name:"DDD",movesCount:130,playTime:700},{name:"EEE",movesCount:140,playTime:800},{name:"FFF",movesCount:150,playTime:900},{name:"GGG",movesCount:160,playTime:1e3},{name:"DDD",movesCount:170,playTime:1100},{name:"MMM",movesCount:180,playTime:1200},{name:"LOL",movesCount:190,playTime:1300},{name:"KEK",movesCount:200,playTime:1400}],5:[{name:"KKK",movesCount:300,playTime:600},{name:"BBB",movesCount:320,playTime:700},{name:"LOL",movesCount:330,playTime:800},{name:"DDD",movesCount:340,playTime:900},{name:"EEE",movesCount:350,playTime:1e3},{name:"FFF",movesCount:360,playTime:1100},{name:"FOX",movesCount:370,playTime:1200},{name:"HHH",movesCount:380,playTime:1300},{name:"JJJ",movesCount:390,playTime:1400},{name:"KKK",movesCount:400,playTime:1500}],6:[{name:"AAA",movesCount:500,playTime:2e3},{name:"LOL",movesCount:520,playTime:2200},{name:"CCC",movesCount:530,playTime:2300},{name:"FOX",movesCount:540,playTime:2400},{name:"EEE",movesCount:550,playTime:2500},{name:"FFF",movesCount:560,playTime:2600},{name:"BUG",movesCount:570,playTime:2700},{name:"HHH",movesCount:580,playTime:2800},{name:"KEK",movesCount:590,playTime:2900},{name:"KKK",movesCount:500,playTime:3e3}],7:[{name:"AAA",movesCount:700,playTime:3e3},{name:"BBB",movesCount:710,playTime:3100},{name:"CCC",movesCount:730,playTime:3200},{name:"LEL",movesCount:740,playTime:3300},{name:"EEE",movesCount:750,playTime:3350},{name:"FFF",movesCount:760,playTime:3400},{name:"GGG",movesCount:770,playTime:3450},{name:"VAS",movesCount:780,playTime:3500},{name:"IDA",movesCount:790,playTime:3550},{name:"REA",movesCount:853,playTime:3559}],8:[{name:"FOX",movesCount:1e3,playTime:3e3},{name:"LOL",movesCount:1020,playTime:3100},{name:"KEK",movesCount:1030,playTime:3200},{name:"REA",movesCount:1040,playTime:3300},{name:"ALX",movesCount:1050,playTime:3400},{name:"MRX",movesCount:1060,playTime:3500},{name:"JHO",movesCount:1070,playTime:3510},{name:"ING",movesCount:1080,playTime:3520},{name:"INP",movesCount:1090,playTime:3530},{name:"VOX",movesCount:1100,playTime:3540}]},playTime:0,movesCount:0,inGame:!1,gameTimerId:null,cheatMode:!1,dragndrop:!1,dragableStartPosX:0,dragableStartPosY:0,dragableEndPosX:0,dragableEndPosY:0,animationDropableTime:400,inDropable:!1},i=(e,t)=>!!s.ls_available&&(localStorage.setItem(e,JSON.stringify(t)),!0),m=e=>!!s.ls_available&&JSON.parse(localStorage.getItem(e)),d=e.p+"assets/6e1f7ceff265ea7fe037.mp3",l=()=>{s.gameTimerId=setInterval((()=>{s.playTime=s.playTime+1,R()}),1e3),s.inGame=!0},c=()=>{s.gameTimerId&&clearInterval(s.gameTimerId),s.inGame=!1,s.playTime=0,s.movesCount=0,s.gameTimerId=null,H(),R()},u=()=>{s.dragndrop=!1},p=()=>{s.movesCount+=1,H()},g=()=>s.gameArray.flat().join("")===s.gameWinArray.flat().join(""),v=()=>{clearInterval(s.gameTimerId),s.inGame=!1,s.gameSettings.sound&&new Audio(d).play();const e=document.querySelector(".popup_overlay"),n=document.querySelector(".popup_card");n.innerHTML="",document.createElement("div").classList.add("victory_title"),n.innerHTML=`\n    <h3 class='victory_title'>!!! VICTORY !!!</h3>\n    <div class='victory_subtitle'>Hooray! You solved the puzzle in ${t(s.playTime)} and ${s.movesCount} moves!</div>\n  `;const a=document.createElement("div");if(a.classList.add("close_popup"),a.addEventListener("click",(()=>{e.classList.remove("popup_overlay_active")})),n.append(a),s.movesCount<s.records[s.gameSettings.currentBoardSize][9].movesCount){const t=document.createElement("input"),a=document.createElement("div");a.classList.add("newrecord_title");const o=document.createElement("h4");o.innerText="Congratulations! This is a new record!";const r=document.createElement("br"),s=document.createElement("span");s.innerText="Enter your name:",n.append(a,o,r,s),t.type="text",t.className="record_name",t.placeholder="Input your name here... max 10 symbols",t.oninput=()=>{t.value.length>8&&(t.value=t.value.slice(0,8))};const i=document.createElement("button");i.innerText="SAVE",i.classList.add("btnRecords_save"),i.addEventListener("click",(()=>{y(t.value),e.classList.remove("popup_overlay_active")})),n.append(t,i)}e.classList.add("popup_overlay_active")},y=e=>{const t=s.gameSettings.currentBoardSize,{movesCount:n,playTime:a}=s;console.log(s.records[t]),s.records[t].push({name:e,movesCount:n,playTime:a}),s.records[t].sort(((e,t)=>e.movesCount-t.movesCount)),s.records[t]=s.records[t].slice(0,10),console.log(s.records[t]),i(s.ls_key_records,s.records)},T=e=>{const n=s.records[e],a=(e,t,n,a)=>{const o=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),i=document.createElement("div");return o.classList.add("records_num"),r.classList.add("records_name"),s.classList.add("records_moves"),i.classList.add("records_time"),o.innerText=e,r.innerText=t,s.innerText=n,i.innerText=a,[o,r,s,i]},o=[],r=a("№","NAME","MOVES","TIME"),i=document.createElement("div");i.classList.add("record_str"),i.append(...r),o.push(i);for(let e=0;e<n.length;e++){const r=document.createElement("div");r.classList.add("record_str");const s=a(e+1,n[e].name,n[e].movesCount,t(n[e].playTime));r.append(...s),o.push(r)}return o},b=()=>{const e={sound:s.gameSettings.sound,currentBoardSize:s.gameSettings.currentBoardSize};i(s.ls_key_settings,e)},S=()=>{const e=s.gameSettings.currentBoardSize;s.gameArray=[],s.gameWinArray=[];for(let t=0;t<e;t++){const n=[];for(let a=0;a<e;a++)n.push(t*e+a+1);s.gameArray.push(n)}s.gameArray[e-1][e-1]=0;for(let e=0;e<s.gameArray.length;e++)s.gameWinArray.push([...s.gameArray[e]])},C=e.p+"assets/c7ea62c4967b91c643bc.mp3",E=e.p+"assets/952d6d7245270401f426.mp3",_=e.p+"assets/d0c05eae0a0cf06463b5.mp3",L=e.p+"assets/d6b189d8b2681bc52026.mp3",h=()=>{c(),S(),s.gameSettings.sound&&new Audio(E).play(),s.gameArray=s.cheatMode?a(s.gameArray,7,!0):a(s.gameArray),s.movesCount=0,s.inGame=!0,I(),l()},f=e=>{c(),s.gameSettings.currentBoardSize=e.target.value,b(),S(),I()},A=e=>{const t=e.target.dataset.r,a=e.target.dataset.c,o=document.querySelector(".dropable"),r=o.dataset.r,i=o.dataset.c;n(s.gameArray,r,i,t,a),p(),e.target.classList.remove(`move_${s.animationDirection}`),s.animationDirection=null,I(),g()&&(console.log("win"),v()),document.querySelector("#board").addEventListener("mouseup",k)},B=e=>{s.inGame&&null!==r(s.gameArray,+e.target.dataset.r,+e.target.dataset.c)&&(s.dragndrop=!0,setTimeout((()=>{if(!s.dragndrop)return;const t=e.target;if(!t||"dropable"===t.id)return;const a=document.querySelector(`#${e.target.id}`);let o=e.clientX-a.getBoundingClientRect().left,r=e.clientY-a.getBoundingClientRect().top;const i=document.createElement("div");i.classList.add("cell"),i.innerHTML=a.innerHTML,i.style.cursor="grabbing",i.style.width=a.getBoundingClientRect().width+"px",i.style.height=a.getBoundingClientRect().height+"px",document.body.append(i),i.style.position="absolute",i.style.zIndex=1e3,i.style.opacity=.75,i.style.fontSize=s.gameSettings.currentBoardSize<6?"2rem":"1rem",s.dragableStartPosX=a.getBoundingClientRect().left,s.dragableStartPosY=a.getBoundingClientRect().top;const m=(e,t)=>{i.style.left=e-o+"px",i.style.top=t-r+"px"};let d=null;const l=e=>{s.inDropable=!1,e.style.background="",e.style.opacity=0},c=e=>{m(e.pageX,e.pageY),i.classList.add("displaynone");let t=document.elementFromPoint(e.clientX,e.clientY);if(i.classList.remove("displaynone"),!t)return;let n=t.closest("#dropable");var a;d!=n&&(d&&l(d),d=n,d&&(a=d,s.inDropable=!0,a.style.background="#e2f5fc",a.style.opacity=.2))},y=e=>{if(s.inDropable){const e=document.querySelector("#dropable");s.dragableStartPosX=e.getBoundingClientRect().left,s.dragableStartPosY=e.getBoundingClientRect().top}s.dragableEndPosX=i.getBoundingClientRect().left,s.dragableEndPosY=i.getBoundingClientRect().top,i.style.transition=`all ${s.animationDropableTime}ms`,i.style.transform=`translate(${s.dragableStartPosX-s.dragableEndPosX}px, ${s.dragableStartPosY-s.dragableEndPosY}px)`,setTimeout((()=>{if(i.remove(),s.inDropable){const e=a.dataset.r,t=a.dataset.c,o=document.querySelector("#dropable"),r=o.dataset.r,i=o.dataset.c;n(s.gameArray,r,i,e,t),s.gameSettings.sound&&new Audio(_).play(),p(),I(),g()&&v(),l(d)}}),s.animationDropableTime),document.removeEventListener("mousemove",c),i.removeEventListener("mouseup",y)};document.addEventListener("mousemove",c),i.addEventListener("mouseup",y),m(e.pageX,e.pageY),u()}),150))},k=e=>{if(!s.inGame)return;u();const t=e.target;if(t){document.querySelector(`#${e.target.id}`).addEventListener("transitionend",A);const o=r(s.gameArray,+t.dataset.r,+t.dataset.c);o&&(s.gameSettings.sound&&new Audio(C).play(),n=e.target,a=o.direction,s.animationDirection=a,n.classList.add(`move_${a}`))}var n,a},x=()=>{s.ls_available||alert("Для того, чтобы сохранения были доступны, включите возможность записи в localstorage! В насатройках вашего браузера!");const e={gameArray:s.gameArray,gameWinArray:s.gameWinArray,playTime:s.playTime,movesCount:s.movesCount,inGame:s.inGame,gameSettings:{currentBoardSize:s.gameSettings.currentBoardSize}};i(s.ls_key_data,e)},z=()=>{if(!s.ls_available)return void alert("Для того, чтобы сохранения были доступны, включите возможность записи в localstorage! В насатройках вашего браузера!");c();const e=m(s.ls_key_data);if(e){for(const t in e)"gameSettings"!==t?Object.hasOwnProperty.call(e,t)&&(s[t]=e[t]):s.gameSettings.currentBoardSize=+e.gameSettings.currentBoardSize;const t=document.querySelectorAll("#boardsize > option");for(let e=0;e<t.length;e++)t[e].selected=!1,+t[e].value===s.gameSettings.currentBoardSize&&(t[e].selected=!0);I(),H(),R(),l()}},$=e=>{const t=document.querySelectorAll(".btnRecords"),n=e.target.dataset.bSize,a=document.querySelector("#restitle"),o=document.querySelector(".record_table");o.innerHTML="";for(let e=0;e<t.length;e++)t[e].classList.remove("btnRecords_active"),t[e].dataset.bSize===n&&(t[e].classList.add("btnRecords_active"),a.innerHTML=`Best of the best ${n} X ${n}`);o.append(...T(n))},D=()=>{s.gameSettings.sound&&new Audio(L).play();const e=document.querySelector(".popup_overlay"),t=document.querySelector(".popup_card"),n=document.createElement("div"),a=s.gameSettings.currentBoardSize,o=s.gameSettings.boardSizes;n.innerHTML=`<h3 id='restitle'>Best of the best ${a} X ${a}</h3>`;const r=document.createElement("div");r.classList.add("close_popup"),r.addEventListener("click",(()=>e.classList.remove("popup_overlay_active"))),n.append(r);const i=document.createElement("div");i.classList.add("btn_rec_wrapper");for(let e=0;e<o.length;e++){const t=document.createElement("button");t.innerText=`${o[e]} X ${o[e]}`,t.addEventListener("click",$),t.classList.add("btnRecords"),t.dataset.bSize=o[e],o[e]===+a&&t.classList.add("btnRecords_active"),i.append(t)}n.append(i);const m=document.createElement("div");m.classList.add("record_table");const d=T(a);m.append(...d),t.innerHTML="",t.append(n),t.append(m),e.classList.add("popup_overlay_active")},M=e=>{s.gameSettings.sound?(s.gameSettings.sound=!1,e.target.innerText="Sound OFF",e.target.classList.add("btn_sound_disable"),b()):(s.gameSettings.sound=!0,e.target.innerText="Sound ON",e.target.classList.remove("btn_sound_disable"),b())},F=e=>{s.cheatMode=e.target.checked},w=(e,t,n)=>{const a=document.createElement("span");return a.classList.add(...n),a.innerText=`${e}: ${t}`,a},I=()=>{const e=s.gameSettings.currentBoardSize,t=s.gameArray,n=document.getElementById("board"),a=[];n.className="",n.classList.add("board",`board_${e}_${e}`);for(let n=0;n<t.length;n++)for(let o=0;o<t[n].length;o++){const r=n*e+o,s=document.createElement("div");s.id=`cell_${r}`,s.classList.add("cell"),0===t[n][o]&&(s.classList.add("dropable"),s.setAttribute("id","dropable")),s.dataset.r=n,s.dataset.c=o,s.innerText=t[n][o],a.push(s)}n.innerHTML="",n.append(...a)},H=()=>{document.querySelector(".moves_count").innerText=`Moves: ${s.movesCount}`},R=()=>{document.querySelector(".play_time").innerText=`Time: ${t(s.playTime)}`};(()=>{if(s.ls_available=(()=>{try{const e="test";return localStorage.setItem(e,JSON.stringify(e)),localStorage.removeItem(e),!0}catch(e){return console.log(e),!1}})(),s.ls_available){const e=m(s.ls_key_settings);e&&(s.gameSettings.sound=e.sound,s.gameSettings.currentBoardSize=+e.currentBoardSize)}(()=>{const e=m(s.ls_key_records);e&&(s.records=e)})(),S(),(()=>{const e=document.createElement("div");e.classList.add("container");const t=document.createElement("div");t.classList.add("popup_overlay"),t.setAttribute("id","popup_overlay");const n=document.createElement("div");n.classList.add("close_popup");const a=document.createElement("div");return a.classList.add("popup_card"),t.addEventListener("click",(e=>{"popup_overlay"===e.target.id&&(e.stopPropagation(),e.preventDefault(),t.classList.remove("popup_overlay_active"))})),n.addEventListener("click",(()=>{t.classList.remove("popup_overlay_active")})),a.append(n),t.append(a),e.append(t),document.body.innerHTML="",document.body.append(e),e})().append((()=>{const e=s.gameSettings.boardSizes,t=document.createElement("div");t.classList.add("buttons");const n=document.createElement("select");for(let t=0;t<e.length;t++){const a=document.createElement("option");a.setAttribute("value",e[t]),e[t]===s.gameSettings.currentBoardSize&&(a.selected=!0),a.innerText=`${e[t]} X ${e[t]}`,n.append(a)}n.setAttribute("id","boardsize"),n.addEventListener("change",f),t.append(n);const a=document.createElement("button"),o=document.createElement("button"),r=document.createElement("button"),i=document.createElement("button"),m=document.createElement("button");return a.innerText="Shuffle and start",o.innerText=s.gameSettings.sound?"Sound ON":"Sound OFF",r.innerText="Save",i.innerText="Load",m.innerText="Results",s.gameSettings.sound||o.classList.add("btn_sound_disable"),a.addEventListener("click",h),o.addEventListener("click",M),r.addEventListener("click",x),i.addEventListener("click",z),m.addEventListener("click",D),t.append(a,o,r,i,m),t})(),(()=>{const e=document.createElement("div");e.classList.add("stats");const t=w("Moves",0,["moves_count"]),n=w("Time","00:00",["play_time"]);return e.append(t,n),e})(),(()=>{const e=document.createElement("div");return e.classList.add("board"),e.setAttribute("id","board"),e.addEventListener("mousedown",B),e.addEventListener("mouseup",k),e})(),(()=>{const e=document.createElement("label");e.setAttribute("for","cheat"),e.innerText="cheat mode",e.classList.add("cheat_mode"),e.title="Включи этот режим, чтобы уменшить количество перемешиваний. И нажми старт!";const t=document.createElement("input");return t.type="checkbox",t.id="cheat",t.checked=s.cheatMode,t.addEventListener("change",F),e.append(t),e})())})(),I()})();