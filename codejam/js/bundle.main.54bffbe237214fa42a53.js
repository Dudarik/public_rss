(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var a=n.getElementsByTagName("script");a.length&&(t=a[a.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t+"../"})();const t=(e=0)=>{let t=parseInt(e%3600/60,10),n=parseInt(e%3600%60,10);return t=t<10?"0"+t:String(t),n=n<10?"0"+n:String(n),`${t}:${n}`},n=e=>e+1,a=(e,t,n,a,o)=>{[e[t][n],e[a][o]]=[e[a][o],e[t][n]]},o=(e,t=1e3,n=!1)=>{let o=e.length-1,r=e.length-1;n||(e.length>5&&(t=2e3),3===e.length&&(t=100));for(let n=0;n<t;n++)switch(Math.floor(4*Math.random()+0)){case 0:0!==o&&a(e,o,r,--o,r);break;case 1:o!==e.length-1&&a(e,o,r,++o,r);break;case 2:0!==r&&a(e,o,r,o,--r);break;case 3:r!==e.length-1&&a(e,o,r,o,++r)}return e},r=(e,t,n,a)=>!(e<0||t<0||e>n||t>a),s=(e,t,n)=>{if(isNaN(t)||isNaN(n))return null;const a=[-1,0,1,0],o=[0,1,0,-1],s=e.length-1,i=e[0].length-1;for(let d=0;d<a.length;d++)if(r(t+a[d],n+o[d],s,i)&&0===e[t+a[d]][n+o[d]]){if(0===d)return{direction:"up",coords:[t+a[d],n+o[d]]};if(1===d)return{direction:"right",coords:[t+a[d],n+o[d]]};if(2===d)return{direction:"down",coords:[t+a[d],n+o[d]]};if(3===d)return{direction:"left",coords:[t+a[d],n+o[d]]}}return null},i={gameArray:[],gameWinArray:[],gameSettings:{sound:!0,numbers:!0,boardSizes:[3,4,5,6,7,8],currentBoardSize:4},ls_available:!1,ls_key_data:"dudarik_fifteen_data",ls_key_settings:"dudarik_fifteen_settings",ls_key_records:"dudarik_fifteen_records",records:{3:[{name:"AAA",movesCount:100,playTime:150},{name:"BBB",movesCount:150,playTime:250},{name:"CCC",movesCount:160,playTime:350},{name:"DDD",movesCount:170,playTime:450},{name:"EEE",movesCount:200,playTime:550},{name:"FFF",movesCount:250,playTime:650},{name:"GGG",movesCount:300,playTime:750},{name:"HHH",movesCount:350,playTime:850},{name:"JJJ",movesCount:400,playTime:950},{name:"KKK",movesCount:450,playTime:1e3}],4:[{name:"BBB",movesCount:300,playTime:500},{name:"CCC",movesCount:320,playTime:600},{name:"DDD",movesCount:330,playTime:700},{name:"EEE",movesCount:440,playTime:800},{name:"FFF",movesCount:550,playTime:900},{name:"GGG",movesCount:660,playTime:1e3},{name:"DDD",movesCount:770,playTime:1100},{name:"MMM",movesCount:880,playTime:1200},{name:"LOL",movesCount:890,playTime:1300},{name:"KEK",movesCount:900,playTime:1400}],5:[{name:"KKK",movesCount:500,playTime:600},{name:"BBB",movesCount:520,playTime:700},{name:"LOL",movesCount:530,playTime:800},{name:"DDD",movesCount:540,playTime:900},{name:"EEE",movesCount:650,playTime:1e3},{name:"FFF",movesCount:660,playTime:1100},{name:"FOX",movesCount:670,playTime:1200},{name:"HHH",movesCount:880,playTime:1300},{name:"JJJ",movesCount:990,playTime:1400},{name:"KKK",movesCount:999,playTime:1500}],6:[{name:"AAA",movesCount:900,playTime:2e3},{name:"LOL",movesCount:920,playTime:2200},{name:"CCC",movesCount:930,playTime:2300},{name:"FOX",movesCount:940,playTime:2400},{name:"EEE",movesCount:1050,playTime:2500},{name:"FFF",movesCount:1060,playTime:2600},{name:"BUG",movesCount:1170,playTime:2700},{name:"HHH",movesCount:1180,playTime:2800},{name:"KEK",movesCount:1390,playTime:2900},{name:"KKK",movesCount:1600,playTime:3e3}],7:[{name:"AAA",movesCount:1e3,playTime:3e3},{name:"BBB",movesCount:1010,playTime:3100},{name:"CCC",movesCount:1730,playTime:3200},{name:"LEL",movesCount:1740,playTime:3300},{name:"EEE",movesCount:1750,playTime:3350},{name:"FFF",movesCount:1760,playTime:3400},{name:"GGG",movesCount:1770,playTime:3450},{name:"VAS",movesCount:1780,playTime:3500},{name:"IDA",movesCount:1790,playTime:3550},{name:"REA",movesCount:1853,playTime:3559}],8:[{name:"FOX",movesCount:2e3,playTime:3e3},{name:"LOL",movesCount:2020,playTime:3100},{name:"KEK",movesCount:2030,playTime:3200},{name:"REA",movesCount:2040,playTime:3300},{name:"ALX",movesCount:2050,playTime:3400},{name:"MRX",movesCount:2060,playTime:3500},{name:"JHO",movesCount:2070,playTime:3510},{name:"ING",movesCount:2080,playTime:3520},{name:"INP",movesCount:2090,playTime:3530},{name:"VOX",movesCount:9999,playTime:3540}]},playTime:0,movesCount:0,inGame:!1,gameTimerId:null,cheatMode:!1,dragndrop:!1,dragableStartPosX:0,dragableStartPosY:0,dragableEndPosX:0,dragableEndPosY:0,animationDropableTime:400,inDropable:!1},d=(e,t)=>!!i.ls_available&&(localStorage.setItem(e,JSON.stringify(t)),!0),m=e=>!!i.ls_available&&JSON.parse(localStorage.getItem(e)),l=e.p+"assets/6e1f7ceff265ea7fe037.mp3",c=()=>{i.gameTimerId=setInterval((()=>{i.playTime=n(i.playTime),N()}),1e3),i.inGame=!0},u=()=>{i.gameTimerId&&clearInterval(i.gameTimerId),i.inGame=!1,i.playTime=0,i.movesCount=0,i.gameTimerId=null,q(),N()},p=()=>{i.dragndrop=!1},g=()=>{i.movesCount+=1,q()},v=()=>i.gameArray.flat().join("")===i.gameWinArray.flat().join(""),y=()=>{clearInterval(i.gameTimerId),i.inGame=!1,i.gameSettings.sound&&new Audio(l).play();const e=document.querySelector(".popup_overlay"),n=document.querySelector(".popup_card");n.innerHTML="",document.createElement("div").classList.add("victory_title"),n.innerHTML=`\n    <h3 class='victory_title'>!!! VICTORY !!!</h3>\n    <div class='victory_subtitle'>Hooray! You solved the puzzle in ${t(i.playTime)} and ${i.movesCount} moves!</div>\n  `;const a=document.createElement("div");if(a.classList.add("close_popup"),a.addEventListener("click",(()=>{e.classList.remove("popup_overlay_active")})),n.append(a),i.movesCount<i.records[i.gameSettings.currentBoardSize][9].movesCount){const t=document.createElement("input"),a=document.createElement("div");a.classList.add("newrecord_title");const o=document.createElement("h4");o.innerText="Congratulations! This is a new record!";const r=document.createElement("br"),s=document.createElement("span");s.innerText="Enter your name:",n.append(a,o,r,s),t.type="text",t.className="record_name",t.placeholder="Input your name here... max 10 symbols",t.onkeydown=n=>{t.value.length>8&&(t.value=t.value.slice(0,8)),"Enter"===n.key&&(T(t.value),e.classList.remove("popup_overlay_active"))};const i=document.createElement("button");i.innerText="SAVE",i.classList.add("btnRecords_save"),i.addEventListener("click",(()=>{T(t.value),e.classList.remove("popup_overlay_active")})),n.append(t,i)}e.classList.add("popup_overlay_active")},T=(e,t=!1)=>{const n=i.gameSettings.currentBoardSize;let{movesCount:a,playTime:o}=i;t&&(a=1e4,o=4e3),i.records[n].push({name:e,movesCount:a,playTime:o}),i.records[n].sort(((e,t)=>e.movesCount-t.movesCount)),i.records[n]=i.records[n].slice(0,10),d(i.ls_key_records,i.records)},b=()=>{const e=m(i.ls_key_records);e&&(i.records=e)},S=e=>{const n=i.records[e],a=(e,t,n,a)=>{const o=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),i=document.createElement("div");return o.classList.add("records_num"),r.classList.add("records_name"),s.classList.add("records_moves"),i.classList.add("records_time"),o.innerText=e,r.innerText=t,s.innerText=n,i.innerText=a,[o,r,s,i]},o=[],r=a("№","NAME","MOVES","TIME"),s=document.createElement("div");s.classList.add("record_str"),s.append(...r),o.push(s);for(let e=0;e<n.length;e++){const r=document.createElement("div");r.classList.add("record_str");const s=a(e+1,n[e].name,n[e].movesCount,t(n[e].playTime));r.append(...s),o.push(r)}return o},C=()=>{const e={sound:i.gameSettings.sound,currentBoardSize:i.gameSettings.currentBoardSize};d(i.ls_key_settings,e)},E=()=>{i.gameTimerId=setInterval((()=>{i.playTime=n(i.playTime),N()}),1e3)},_=()=>{const e=i.gameSettings.currentBoardSize;i.gameArray=[],i.gameWinArray=[];for(let t=0;t<e;t++){const n=[];for(let a=0;a<e;a++)n.push(t*e+a+1);i.gameArray.push(n)}i.gameArray[e-1][e-1]=0;for(let e=0;e<i.gameArray.length;e++)i.gameWinArray.push([...i.gameArray[e]])},L=e.p+"assets/c7ea62c4967b91c643bc.mp3",f=e.p+"assets/14c688fc1b952ed0a1a2.mp3",h=e.p+"assets/d0c05eae0a0cf06463b5.mp3",A=e.p+"assets/d6b189d8b2681bc52026.mp3",B=e.p+"assets/a4302ea00c61eddeb548.mp3",k=e.p+"assets/0cecdc4785290d298a3d.mp3",w=e.p+"assets/295645536aaabe5d8250.mp3",I=()=>{u(),_(),i.gameSettings.sound&&new Audio(f).play(),i.cheatMode?(i.gameArray=o(i.gameArray,10,!0),i.gameArray.flat().join("")===i.gameWinArray.flat().join("")&&(i.gameArray=o(i.gameArray,10,!0))):i.gameArray=o(i.gameArray),i.movesCount=0,i.inGame=!0,K(),c(),document.querySelectorAll(".cell").forEach((e=>{e.classList.add("start_cell_anim")}))},x=e=>{u(),i.gameSettings.currentBoardSize=e.target.value,C(),_(),K()},z=e=>{const t=e.target.dataset.r,n=e.target.dataset.c,o=document.querySelector(".dropable"),r=o.dataset.r,s=o.dataset.c;a(i.gameArray,r,s,t,n),g(),e.target.classList.remove(`move_${i.animationDirection}`),i.animationDirection=null,K(),v()&&y(),document.querySelector("#board").addEventListener("pointerup",D)},$=e=>{if(!i.inGame)return;if(null===s(i.gameArray,+e.target.dataset.r,+e.target.dataset.c))return;i.dragndrop=!0;const t=document.getElementById("board");setTimeout((()=>{if(!i.dragndrop)return;const n=e.target;if(!n||"dropable"===n.id)return;t.setPointerCapture(e.pointerId);const o=document.querySelector(`#${e.target.id}`);let r=e.clientX-o.getBoundingClientRect().left,s=e.clientY-o.getBoundingClientRect().top;const d=document.createElement("div");d.classList.add("cell"),d.innerHTML=o.innerHTML,d.style.cursor="grabbing",d.style.width=o.getBoundingClientRect().width+"px",d.style.height=o.getBoundingClientRect().height+"px",document.body.append(d),d.style.touchAction="none",d.style.position="absolute",d.style.zIndex=1e3,d.style.opacity=.75,d.style.fontSize=i.gameSettings.currentBoardSize<6?"2rem":"1rem",i.dragableStartPosX=o.getBoundingClientRect().left,i.dragableStartPosY=o.getBoundingClientRect().top;const m=(e,t)=>{const n=o.getBoundingClientRect().width,a=o.getBoundingClientRect().height,i=document.documentElement.clientWidth-n/2,m=document.documentElement.clientHeight-a/2;e<i&&e>n/2&&(d.style.left=e-r+"px"),t<m&&t>a/2&&(d.style.top=t-s+"px")};let l=null;const c=e=>{i.inDropable=!1,e.style.background="",e.style.opacity=0},u=e=>{m(e.pageX,e.pageY),t.releasePointerCapture(e.pointerId),d.classList.add("displaynone");let n=document.elementFromPoint(e.clientX,e.clientY);if(d.classList.remove("displaynone"),!n)return;let a=n.closest("#dropable");var o;l!=a&&(l&&c(l),l=a,l&&(o=l,i.inDropable=!0,o.style.background="#e2f5fc",o.style.opacity=.2))},T=e=>{console.log("mousseUP");const t=e=>{e.target.classList.remove("disappears")};if(i.inDropable){const e=document.querySelector("#dropable");i.dragableStartPosX=e.getBoundingClientRect().left,i.dragableStartPosY=e.getBoundingClientRect().top,o.classList.add("disappears")}i.dragableEndPosX=d.getBoundingClientRect().left,i.dragableEndPosY=d.getBoundingClientRect().top,d.style.transition=`all ${i.animationDropableTime}ms`,d.style.transform=`translate(${i.dragableStartPosX-i.dragableEndPosX}px, ${i.dragableStartPosY-i.dragableEndPosY}px)`,setTimeout((()=>{if(d.remove(),i.inDropable){o.addEventListener("transitionend",t),o.removeEventListener("transitionend",t);const e=o.dataset.r,n=o.dataset.c,r=document.querySelector("#dropable"),s=r.dataset.r,d=r.dataset.c;a(i.gameArray,s,d,e,n),i.gameSettings.sound&&new Audio(h).play(),g(),K(),v()&&y(),c(l)}}),i.animationDropableTime),window.removeEventListener("pointermove",u),d.removeEventListener("pointerup",T)};window.addEventListener("pointermove",u),window.addEventListener("pointerup",T),d.addEventListener("pointerup",T),m(e.pageX,e.pageY),p()}),150)},D=e=>{if(!i.inGame)return;p();const t=e.target;if(t){const o=document.querySelector(`#${e.target.id}`);if("dropable"===o.id||"board"===o.id)return;o.addEventListener("transitionend",z);const r=s(i.gameArray,+t.dataset.r,+t.dataset.c);r&&(i.gameSettings.sound&&new Audio(L).play(),n=e.target,a=r.direction,i.animationDirection=a,n.classList.add(`move_${a}`))}var n,a},M=e=>{e.target.classList.remove("save_not_work")},F=e=>{if(i.ls_available||alert("Для того, чтобы сохранения были доступны, включите возможность записи в localstorage! В насатройках вашего браузера!"),!i.inGame){if(i.gameSettings.sound){const e=new Audio(k);e.volume=.5,e.play()}return void e.target.classList.add("save_not_work")}i.gameSettings.sound&&new Audio(B).play();const t={gameArray:i.gameArray,gameWinArray:i.gameWinArray,playTime:i.playTime,movesCount:i.movesCount,inGame:i.inGame,gameSettings:{currentBoardSize:i.gameSettings.currentBoardSize}};d(i.ls_key_data,t)},G=()=>{if(!i.ls_available)return void alert("Для того, чтобы сохранения были доступны, включите возможность записи в localstorage! В насатройках вашего браузера!");i.gameSettings.sound&&new Audio(w).play(),u();const e=m(i.ls_key_data);if(e){for(const t in e)"gameSettings"!==t?Object.hasOwnProperty.call(e,t)&&(i[t]=e[t]):i.gameSettings.currentBoardSize=+e.gameSettings.currentBoardSize;const t=document.querySelectorAll("#boardsize > option");for(let e=0;e<t.length;e++)t[e].selected=!1,+t[e].value===i.gameSettings.currentBoardSize&&(t[e].selected=!0);K(),q(),N(),c()}},R=e=>{const t=document.querySelectorAll(".btnRecords"),n=e.target.dataset.bSize,a=document.querySelector("#restitle"),o=document.querySelector(".record_table");o.innerHTML="";for(let e=0;e<t.length;e++)t[e].classList.remove("btnRecords_active"),t[e].dataset.bSize===n&&(t[e].classList.add("btnRecords_active"),a.innerHTML=`Best of the best ${n} X ${n}`);o.append(...S(n))},H=()=>{if(i.gameSettings.sound){const e=new Audio(A);e.volume=.5,e.play()}const e=document.querySelector(".popup_overlay"),t=document.querySelector(".popup_card"),n=document.createElement("div"),a=i.gameSettings.currentBoardSize,o=i.gameSettings.boardSizes;n.innerHTML=`<h3 id='restitle'>Best of the best ${a} X ${a}</h3>`;const r=document.createElement("div");r.classList.add("close_popup"),r.addEventListener("click",(()=>{e.classList.remove("popup_overlay_active"),i.inGame&&E()})),n.append(r);const s=document.createElement("div");s.classList.add("btn_rec_wrapper");for(let e=0;e<o.length;e++){const t=document.createElement("button");t.innerText=`${o[e]} X ${o[e]}`,t.addEventListener("click",R),t.classList.add("btnRecords"),t.dataset.bSize=o[e],o[e]===+a&&t.classList.add("btnRecords_active"),s.append(t)}n.append(s);const d=document.createElement("div");d.classList.add("record_table");const m=S(a);d.append(...m),t.innerHTML="",t.append(n),t.append(d),e.classList.add("popup_overlay_active"),i.gameTimerId&&(clearInterval(i.gameTimerId),i.gameTimerId=null)},P=e=>{i.gameSettings.sound?(i.gameSettings.sound=!1,e.target.innerText="Sound OFF",e.target.classList.add("btn_sound_disable"),C()):(i.gameSettings.sound=!0,e.target.innerText="Sound ON",e.target.classList.remove("btn_sound_disable"),C())},X=e=>{i.cheatMode=e.target.checked},O=(e,t,n)=>{const a=document.createElement("span");return a.classList.add(...n),a.innerText=`${e}: ${t}`,a},K=()=>{const e=i.gameSettings.currentBoardSize,t=i.gameArray,n=document.getElementById("board"),a=[];n.className="",n.classList.add("board",`board_${e}_${e}`);for(let n=0;n<t.length;n++)for(let o=0;o<t[n].length;o++){const r=n*e+o,s=document.createElement("div");s.id=`cell_${r}`,s.classList.add("cell"),0===t[n][o]&&(s.classList.add("dropable"),s.setAttribute("id","dropable")),s.dataset.r=n,s.dataset.c=o,s.innerText=t[n][o],a.push(s)}n.innerHTML="",n.append(...a)},q=()=>{document.querySelector(".moves_count").innerText=`Moves: ${i.movesCount}`},N=()=>{document.querySelector(".play_time").innerText=`Time: ${t(i.playTime)}`};(()=>{if(i.ls_available=(()=>{try{const e="test";return localStorage.setItem(e,JSON.stringify(e)),localStorage.removeItem(e),!0}catch(e){return console.log(e),!1}})(),i.ls_available){const e=m(i.ls_key_settings);e&&(i.gameSettings.sound=e.sound,i.gameSettings.currentBoardSize=+e.currentBoardSize),b()||T("test",!0)}b(),_(),(()=>{const e=document.createElement("div");e.classList.add("container");const t=document.createElement("div");t.classList.add("popup_overlay"),t.setAttribute("id","popup_overlay");const n=document.createElement("div");n.classList.add("close_popup");const a=document.createElement("div");return a.classList.add("popup_card"),t.addEventListener("click",(e=>{"popup_overlay"===e.target.id&&(e.stopPropagation(),e.preventDefault(),t.classList.remove("popup_overlay_active"),i.inGame&&E())})),n.addEventListener("click",(()=>{t.classList.remove("popup_overlay_active"),i.inGame&&E()})),a.append(n),t.append(a),e.append(t),document.body.innerHTML="",document.body.append(e),e})().append((()=>{const e=i.gameSettings.boardSizes,t=document.createElement("div");t.classList.add("buttons");const n=document.createElement("select");for(let t=0;t<e.length;t++){const a=document.createElement("option");a.setAttribute("value",e[t]),e[t]===i.gameSettings.currentBoardSize&&(a.selected=!0),a.innerText=`${e[t]} X ${e[t]}`,n.append(a)}n.setAttribute("id","boardsize"),n.addEventListener("change",x),t.append(n);const a=document.createElement("button"),o=document.createElement("button"),r=document.createElement("button"),s=document.createElement("button"),d=document.createElement("button");return a.innerText="Shuffle and start",o.innerText=i.gameSettings.sound?"Sound ON":"Sound OFF",r.innerText="Save",s.innerText="Load",d.innerText="Results",i.gameSettings.sound||o.classList.add("btn_sound_disable"),a.addEventListener("click",I),o.addEventListener("click",P),r.addEventListener("click",F),r.addEventListener("animationend",M),s.addEventListener("click",G),d.addEventListener("click",H),t.append(a,o,r,s,d),t})(),(()=>{const e=document.createElement("div");e.classList.add("stats");const t=O("Moves",0,["moves_count"]),n=O("Time","00:00",["play_time"]);return e.append(t,n),e})(),(()=>{const e=document.createElement("div");return e.classList.add("board"),e.setAttribute("id","board"),e.addEventListener("pointerdown",$),e.addEventListener("pointerup",D),e})(),(()=>{const e=document.createElement("label");e.setAttribute("for","cheat"),e.innerText="easy mode",e.classList.add("cheat_mode"),e.title="Включи этот режим, чтобы уменшить количество перемешиваний. И нажми 'shuffle and start!'";const t=document.createElement("input");return t.type="checkbox",t.id="cheat",t.checked=i.cheatMode,t.addEventListener("change",X),e.append(t),e})())})(),K()})();